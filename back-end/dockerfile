FROM python:3.7

COPY requirements.txt requirements.txt

RUN pip install --no-cache-dir -r requirements.txt

COPY . back-end

WORKDIR /back-end

RUN chmod +x start.sh

EXPOSE 8000

# Check if .venv directory exists
RUN if [ -d ".venv" ]; then \
    bash -c "source .venv/bin/activate"; \
    else \
    python -m venv .venv; \
    bash -c "source .venv/bin/activate"; \
    fi

CMD ["sh", "start.sh"]